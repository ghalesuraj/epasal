"use strict";function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}!function(t){var n={onInit:function(){},onStart:function(){},onStop:function(){},onEnd:function(){},onChangeStart:function(){},onChangeEnd:function(){}},e={stopped:!0,timezone:0,diff:null,isEnd:!1},a=function(a,o){var i=this;a.nodeType===Node.ELEMENT_NODE?i.container=t(a):"string"==typeof a?(i.selector=a,i.container=t(i.selector)):"object"===_typeof(a)&&(o=a,i.selector=o.selector,i.container=t(i.selector)),i.options=t.extend({},{selector:"#psgTimer",animation:!1,multipleBlocks:!1,endDateTime:void 0,currentDateTime:Date.now(),labelPlacement:i.container.attr("data-label-placement")?i.container.attr("data-label-placement"):"outside",labels:{days:!!i.container.attr("data-label-days")&&i.container.attr("data-label-days"),hours:!!i.container.attr("data-label-hours")&&i.container.attr("data-label-hours"),minutes:!!i.container.attr("data-label-minutes")&&i.container.attr("data-label-minutes"),seconds:!!i.container.attr("data-label-seconds")&&i.container.attr("data-label-seconds")}},o),i.callbacks=i.options.callbacks=t.extend({},n,i.options.callbacks),i.base=t.extend({},e),"string"==typeof i.options.endDateTime&&(i.options.endDateTime=r(i,i.options.endDateTime)),i.container.length?i.init():console.log("No timer element on this page")};a.prototype.init=function(){var t=this,n=this.options,e=t.container.attr("data-timer-end");void 0!==e&&(n.endDateTime=r(t,e)),t.countdown=i(o(t),n.multipleBlocks),t.container.addClass("psgTimer").append(s(t)),n.animation&&t.container.addClass("psgTimer_"+n.animation),t.query=c(t),t.callbacks.onInit(),t.base.isEnd||t.start()},a.prototype.start=function(){var t=this;t.base.stopped&&(t.base.stopped=!1,t.intervalId=setInterval((function(){d(t)}),1e3),t.callbacks.onStart())},a.prototype.restart=function(){this.options.currentDateTime=Date.now(),this.start()},a.prototype.stop=function(){var t=this;t.base.stopped=!0,clearTimeout(t.intervalId),t.callbacks.onStop()},t.fn.psgTimer=function(n){return t(this).each((function(){var e=t(this),o=e.data("psgTimer");if(!n)throw new Error("Invalid Options");if(o){if("string"==typeof n){switch(n){case"start":o.start();break;case"stop":o.stop();break;case"restart":o.restart();break;default:throw new Error("Invalid Method")}return}o.stop()}o=new a(e.get(0),n),e.data("psgTimer",o)})),this};var o=function(t){var n=t.options,e=t.base;n.currentDateTime=n.currentDateTime+1001,e.diff=n.endDateTime-n.currentDateTime;var a=0,o=0,i=0,r=0;if(e.diff>0){var s=parseFloat((e.diff/1e3/60/60/24).toString());r=parseInt(s.toString()),s-=r,s*=24,i=parseInt(s.toString()),s-=i,s*=60,o=parseInt(s.toString()),s-=o,s*=60,a=parseInt(s.toString())}else t.callbacks.onEnd(),t.stop(),t.base.isEnd=!0;return{days:{amount:r,max:1/0,className:"days"},hours:{amount:i,max:24,className:"hours"},minutes:{amount:o,max:60,className:"minutes"},seconds:{amount:a,max:60,className:"seconds"}}},i=function(t,n){if("object"===_typeof(t))for(var e in t)t.hasOwnProperty(e)&&(t[e].amount=t[e].amount.toString(),t[e].amount.length<2&&(t[e].amount="0"+t[e].amount),t[e].amount=n?t[e].amount.split(""):[t[e].amount]);return t},r=function(t,n){for(var e,a,o,i,r,s={},l=n.split(" "),c=/^([0-1]\d|2[0-3])(:[0-5]\d){1,2}$/,u=/(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d/,d=/(UTC|GMT)[+-](\d{1,2}([:,.]?\d{2})?)/,m=0;m<l.length;m++)l[m].match(c)?s.time=l[m].split(":"):l[m].match(u)?s.date=l[m].split("."):l[m].match(d)?t.base.timezone=(e=l[m],a=void 0,o=void 0,i=void 0,r=void 0,i=e.replace(/\D/g,""),r="-"===e.replace(/[^+-]/g,"")?-1:1,i.length>=3?(a=Number(i.substr(0,i.length-2)),o=Number(i.substr(i.length-2,2))):(a=Number(i),o=0),(a+o/60)*r):console.log("Wrong end time.");return s.year=parseInt(s.date[2])||0,s.month=parseInt(s.date[1])-1||0,s.day=parseInt(s.date[0])||0,s.hours=parseInt(s.time[0])||0,s.minutes=parseInt(s.time[1])||0,s.seconds=parseInt(s.time[2])||0,s.miliseconds=parseInt(s.time[3])||0,Date.UTC(s.year,s.month,s.day,s.hours,s.minutes,s.seconds,s.miliseconds)},s=function(t){var n=t.countdown,e={unit:""},a=t.options.labels,o=t.options.labelPlacement;"auto"===o&&(o="rtl"===document.dir?"before":"after");var i=function(){if(n.hasOwnProperty(r)){var i="";if(n[r].amount.forEach((function(n){i+=l(t,n)})),"outside"!==o){var s=a[r]?'<div class="psg-timer--label '+r+'">'+a[r]+"</div>":"";e.unit+='<div class="'+n[r].className+' psgTimer_unit">'+("before"===o?s+i:i+s)+"</div>"}else e.unit+='<div class="'+n[r].className+' psgTimer_unit">'+i+" </div>"}};for(var r in n)i();if(e.numbers='<div class="psgTimer_numbers">'+e.unit+"</div>",e.full=e.numbers,"outside"!==o)return e.full;if(Object.values(a).filter((function(t){return!!t})).length){e.labels='<div class="psgTimer_labels">';for(var s=0,c=Object.keys(a);s<c.length;s++){var u=c[s];e.labels+='<div class="psg-timer--label '+u+'">'+a[u]+"</div>"}e.labels+="</div>",e.full=e.numbers+e.labels}else e.full=e.numbers;return e.full},l=function(t,n){var e='<div class="number" '+('data-number="'+n+'"')+">"+n+"</div>";return"fade"===t.options.animation?"<div>"+e+"</div>":e},c=function(t){var n=t.countdown,e={};for(var a in n)n.hasOwnProperty(a)&&(e[a]=t.container.find(u(t,n[a].className)));return e},u=function(t,n){return t.options.animation,"."+n+" .number"},d=function(t){t.callbacks.onChangeStart(),t.countdown=i(o(t),t.options.multipleBlocks);var n=function(n){t.countdown.hasOwnProperty(n)&&t.countdown[n].amount.forEach((function(e,a){t.query[n][a].getAttribute("data-number")!==e&&m(t.query[n][a],e,t.options.animation)}))};for(var e in t.countdown)n(e);t.callbacks.onChangeEnd()},m=function(n,e,a){var o=t(n);o.attr("data-number",e),"fade"===a?p.fade(o,e):o.html(e)},p={fade:function(t,n){t.css({transition:"opacity 350ms",opacity:"0"}),setTimeout((function(){t.html(n).css("opacity",1)}),360)}};window.PsgTimer=a}(jQuery);